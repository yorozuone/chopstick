<?php
namespace core;

class dispatch {
    // --------------------------------------------------------------------------------
    // コントローラーをパラメーターに従って実行
    // --------------------------------------------------------------------------------
    public static function run($controller_name, $action_name, $params)
    {
        // ------------------------------------------------------------
        // コントローラー作成
        // ------------------------------------------------------------
        $c = new $controller_name;
        //
        $c->controller_name = $controller_name;
        $c->action_name = $action_name;
        $c->params = $params;
        // ------------------------------------------------------------
        // 既定（開始時）のアクションの実行
        // ------------------------------------------------------------
        if (method_exists($c, 'before'))
        {
            $c->before($params);
        }
        // ------------------------------------------------------------
        // アクションの実行
        // ------------------------------------------------------------
        $c->$action_name($params);
        // ------------------------------------------------------------
        // 既定（終了時）アクションの実行
        // ------------------------------------------------------------
        if (method_exists($c, 'after'))
        {
            $c->after($params);
        }
        return true;
    } 
}
